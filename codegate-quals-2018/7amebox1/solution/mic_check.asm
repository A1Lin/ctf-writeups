0x0:  call main ; 0x9
0x5:  xor r0, r0
0x7:  syscall
main:
0x9:  push bp
0xb:  mov bp, sp
0xd:  sub sp, 0x3c
0x12:  mov r5, bp
0x14:  sub r5, 0x3
0x19:  mov r6, 0x12345 ; canary
0x1e:  mov WORD [r5], r6
0x20:  mov r0, 0xcd
0x25:  call write_str ; 0x90
0x2a:  mov r1, 0x42 ; overflow 6 byte
0x2f:  mov r5, bp
0x31:  sub r5, 0x3c
0x36:  mov r0, r5
0x38:  call read ; 0x60
0x3d:  mov r0, 0xd3
0x42:  call write_str ; 0x90
0x47:  mov r5, bp
0x49:  sub r5, 0x3
0x4e:  mov r6, WORD [r5]
0x50:  cmp r6, 0x12345
0x55:  jnz pc-0x55
0x5a:  mov sp, bp
0x5c:  pop bp
0x5e:  pop pc

read:
0x60:  mov r3, r1
0x62:  mov r2, r0
0x64:  mov r1, 0x0
0x69:  mov r0, 0x3
0x6e:  syscall
0x70:  pop pc

write:
0x72:  push r1
0x74:  push r2
0x76:  push r3
0x78:  mov r3, r1
0x7a:  mov r2, r0
0x7c:  mov r1, 0x1
0x81:  mov r0, 0x2
0x86:  syscall 
0x88:  pop r3
0x8a:  pop r2
0x8c:  pop r1
0x8e:  pop pc

write_str:
0x90:  push r0
0x92:  push r1
0x94:  mov r1, r0
0x96:  call strlen ; 0xa8
0x9b:  swap r0, r1
0x9d:  call write ; 0x72
0xa2:  pop r1
0xa4:  pop r0
0xa6:  pop pc

strlen:
0xa8:  push r1
0xaa:  push r2
0xac:  xor r1, r1
0xae:  xor r2, r2
0xb0:  or LOW r2, BYTE [r0]
0xb2:  cmp byte r2, 0x0
0xb7:  jz pc+0x9
0xbc:  inc r0
0xbe:  inc r1
0xc0:  jmp pc-0x15
0xc5:  mov r0, r1
0xc7:  pop r2
0xc9:  pop r1
0xcb:  pop pc
